
<div>Bienvenido {{gNombreFuncionario()}}</div>
<router-outlet></router-outlet>

<form class="form" *ngIf="gAccess()">
      <div class="form-row">
      <div class="input-data">
        <input type="chart" required class="input" 
               placeholder=" " name="documento" 
               [(ngModel)]="documentoAsociado"
               (keyup)="documentoNumber()"
               >
        <div class="underline"></div>
        <label>Documento Asociado</label>
      </div>
    </div>
    <div clas="form-row" *ngIf="error">
      <p class="error-message">Info invalida</p>
    </div>
    <div class="form-row" *ngIf="!error && nombreAsociado!=='' &&!isLoading ">
      <div class="input-data">
        <input type="chart" required class="" 
               placeholder=" " name="nombreAsociado" 
               [(ngModel)]="nombreAsociado"
               >
        <div class="underline"></div>
        <label>Nombre Asociado</label>
      </div>
    </div>
    <div class="form-row" *ngIf="isLoading">
    <div  class="spinner-container">
      <div class="spinner"></div>
      <p>Loading, please wait...</p>
    </div>
  </div>
    <button 
    [disabled]="isLoading " 
      class="custom-button" (click)="searchData()"> GET DATA</button>
 
</form>

<!-- Lista de Productos -->
<div *ngIf="productList.length > 0" class="dropdown-group">
<select [(ngModel)]="selectedProductIndex" class="dropdown"
  (change)="chooseProduct(selectedProductIndex!)">
  <option *ngFor="let product of productList; let i = index" [value]="i" >
    {{ product['Nombre Producto'] }} </option>
</select>
</div>

<!-- Informacion del Producto -->
<form class="form">
<div class="form-row">
    <div class="input-data">
      <input type="chart" required class="input" 
             placeholder=" " name="Nombre Producto"
             [(ngModel)]="product['Nombre Producto']">
      <div class="underline"></div>
      <label>Nombre Producto</label>
    </div>
</div>  

<div class="form-row">
      <div class="checkbox-wrapper">
        <label>Tarjeta</label>
        <input type="checkbox" name="tipo de producto" [(ngModel)]="isTarjeta" (change)="tipoDeProducto($event)">
        <label>Refinanciar</label>
        <input type="checkbox" name="refinanciamiento" [(ngModel)]="isRef" (change)="eleccionRef($event)"/>
      </div>
</div>
  
<div class="form-row" *ngFor="let field of [
    'Deuda Actual',
    'Plazo Actual',
    'Pago Mensual',
    'Tasa Entidad',
    ]; let i = index">
<div class="input-data">
  <input 
    type="chart"
    required 
    class="input" 
    placeholder=" " 
    [name]="'input' + i" 
    [(ngModel)]="product[field]"
    (keyup)="fNumber(field)"
    >
  <div class="underline"></div>
  <label>{{ field | titlecase }}</label>
</div>
</div>

<div class="form-row" *ngFor="let field of [
    'Tasa Real',
    'Diferencia Tasas',
    'Interes Actual',
    'Interes Beneficiar',
    'Diferencia Interes'
    ]; let i = index">
<div class="output-data">
  <div class="output">{{ product[field] }}</div>
  <label class="chart">{{ field | titlecase }}</label>
  <div class="underline"></div>
</div>
</div>

<div class="form-row">
      <div class="input-data">
        <input type="chart" required class="input" 
       placeholder=" " name="Tasa Beneficiar" 
       [(ngModel)]="product['Tasa Beneficiar']"
       (keyup)="calcularInteresBeneficiar()"
       (keypress)="allowNumbers($event,'Tasa Beneficiar')"

       [ngStyle]="{'color': num(product['Tasa Beneficiar']) < 0 ? 'red' : 'green'}">
        <div class="underline"></div>
        <label>Tasa Beneficiar</label>
      </div>
</div>

</form>

<!-- Modificar Lista de Productos -->
<form class="formB">
    <button class="custom-buttonB" (click)="addProduct()">
      {{ selectedProductIndex === null ? 'Agregar Producto' : 'Actualizar Producto' }}
    </button>
    <button *ngIf="productList.length > 0" class="custom-buttonB" (click)="resetForm()">Nuevo Producto  </button>
    <button *ngIf="productList.length > 0" class="custom-buttonB" (click)="toggleProductList() ">Mostrar Productos</button> 
    <button *ngIf="productList.length > 0" class="custom-buttonB delete" (click)="deleteProduct(selectedProductIndex!)">Eliminar Producto</button>
</form>

